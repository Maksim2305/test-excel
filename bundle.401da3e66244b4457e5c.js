/*! For license information please see bundle.401da3e66244b4457e5c.js.LICENSE.txt */
(function(){"use strict";var __webpack_modules__={665:function(__unused_webpack_module,__webpack_exports__,__webpack_require__){function parseStr(){var value=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";try{if(value.startsWith("="))return eval(value.slice(1))}catch(t){return value}return value}__webpack_require__.d(__webpack_exports__,{$:function(){return parseStr}})}},__webpack_module_cache__={};function __webpack_require__(t){var e=__webpack_module_cache__[t];if(void 0!==e)return e.exports;var r=__webpack_module_cache__[t]={exports:{}};return __webpack_modules__[t](r,r.exports,__webpack_require__),r.exports}__webpack_require__.d=function(t,e){for(var r in e)__webpack_require__.o(e,r)&&!__webpack_require__.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},__webpack_require__.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)};var __webpack_exports__={};!function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var e=function(){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),this.$el="string"==typeof t?document.querySelector(t):t}var n,o;return n=e,o=[{key:"html",value:function(t){return"string"==typeof t?(this.$el.innerHTML=t,this):this.$el.outerHTML.trim()}},{key:"text",value:function(t){return void 0!==t?(this.$el.textContent=t,this):"input"===this.$el.tagName.toLowerCase()?this.$el.value.trim():this.$el.textContent.trim()}},{key:"clear",value:function(){return this.html(""),this}},{key:"append",value:function(t){return t instanceof e&&(t=t.$el),Element.prototype.append?this.$el.append(t):this.$el.appendChild(t),this}},{key:"on",value:function(t,e){this.$el.addEventListener(t,e)}},{key:"off",value:function(t,e){this.$el.removeEventListener(t,e)}},{key:"closest",value:function(t){return r(this.$el.closest(t))}},{key:"getCoords",value:function(){return this.$el.getBoundingClientRect()}},{key:"data",get:function(){return this.$el.dataset}},{key:"findAll",value:function(t){return this.$el.querySelectorAll(t)}},{key:"find",value:function(t){return r(this.$el.querySelector(t))}},{key:"selectedIds",get:function(){return this.group.map((function(t){return t.id()}))}},{key:"id",value:function(t){if(t){var e=this.id().split(":");return{row:+e[0],col:+e[1]}}return this.data.id}},{key:"css",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object.keys(e).forEach((function(r){t.$el.style[r]=e[r]}))}},{key:"addClass",value:function(t){this.$el.classList.add(t)}},{key:"removeClass",value:function(t){this.$el.classList.remove(t)}},{key:"focus",value:function(){return this.$el.focus(),this}},{key:"getStyles",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return e.reduce((function(e,r){return e[r]=t.$el.style[r],e}),{})}},{key:"attr",value:function(t,e){return e?(this.$el.setAttribute(t,e),this):this.$el.getAttribute(t)}}],o&&t(n.prototype,o),Object.defineProperty(n,"prototype",{writable:!1}),e}();function r(t){return new e(t)}function n(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}r.create=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=document.createElement(t);return e&&n.classList.add(e),r(n)};var o=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.params=e}var e,r;return e=t,(r=[{key:"getRoot",value:function(){throw new Error('Method "getRoot" should be implemented')}},{key:"afterRender",value:function(){}},{key:"destroy",value:function(){}}])&&n(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();function i(t){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i(t)}function c(t,e){if(t>e){var r=[t,e];e=r[0],t=r[1]}return new Array(e-t+1).fill("").map((function(e,r){return t+r}))}function a(t,e){if(!e)return JSON.parse(localStorage.getItem(t));localStorage.setItem(t,JSON.stringify(e))}function u(t){return t.replace(/([A-Z])/g,(function(t){return"-".concat(t[0].toLowerCase())}))}function l(t,e){var r;return function(){for(var n=this,o=arguments.length,i=new Array(o),c=0;c<o;c++)i[c]=arguments[c];var a=function(){clearTimeout(r),t.apply(n,i)};clearTimeout(r),r=setTimeout(a,e)}}function s(t){t.preventDefault()}function f(t){var e=a(t).currentTitle,r=t.split(":")[1];return new Date(a(t).createDate).toLocaleDateString(),'\n    <li class="db__record">\n        <a href="#excel/'.concat(r,'">').concat(e,"</a>\n        <strong>\n        ").concat(new Date(a(t).createDate).toLocaleDateString(),"\n        ").concat(new Date(a(t).createDate).toLocaleTimeString(),"\n        </strong>\n    </li>\n    ")}function p(t){return p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},p(t)}function y(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function h(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function b(t,e){return b=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},b(t,e)}function v(t,e){if(e&&("object"===p(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function d(t){return d=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},d(t)}var g=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&b(t,e)}(a,t);var e,n,o,i,c=(o=a,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=d(o);if(i){var r=d(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return v(this,t)});function a(){return y(this,a),c.apply(this,arguments)}return e=a,(n=[{key:"getRoot",value:function(){var t,e=Date.now().toString();return r.create("div","db").html('\n            <div class="db__header">\n            <h1>Excel Dashboard</h1>\n            </div> \n\n            <div class="db__new">\n                <div class="db__view">\n                <a href="#excel/'.concat(e,'" class="db__create">\n                    Новая <br /> Таблица\n                </a>\n                </div>\n            </div>\n\n            <div class="db__table db__view">\n\n            ').concat((t=function(){for(var t=[],e=0;e<localStorage.length;e++)localStorage.key(e).includes("excel")&&t.push(localStorage.key(e));return t}()).length?'\n    <div class="db__list-header">\n    <span>Название</span>\n    <span>Дата открытия</span>\n    </div>\n\n    <ul class="db__list">\n        '.concat(t.map(f).join(""),"\n    </ul>\n    "):"<p>Нет записей!</p>","\n\n            </div>\n            "))}}])&&h(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),a}(o);function m(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function w(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function O(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var j=function(){function t(e,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.rootReducer=e,this.state={},this.listeners=[],this.state=e(function(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?m(Object(r),!0).forEach((function(e){w(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):m(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}({},r),{type:"__INIT__"})}var e,r;return e=t,(r=[{key:"subscribe",value:function(t){return this.listeners.push(t),{unsubscribe:function(){var e;this.listeners=null===(e=this.listeners)||void 0===e?void 0:e.filter((function(e){return e!==t}))}}}},{key:"dispatch",value:function(t){var e=this;this.state=this.rootReducer(this.state,t),this.listeners.forEach((function(t){t(e.state)}))}},{key:"getState",value:function(){return JSON.parse(JSON.stringify(this.state))}}])&&O(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),t}(),_="TABLE_RESIZE",P="CHANGE_TEXT",S="APPLY_STYLE",k="CHANGE_STYLE",E="CHANGE_TITLE",x="UPDATE_DATE";function T(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function D(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?T(Object(r),!0).forEach((function(e){R(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):T(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function R(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function L(t,e){var r,n,o,i;switch(e.type){case _:return(o=t[n="col"===e.data.type?"colState":"rowState"]||{})[e.data.id]=e.data.value,D(D({},t),{},R({},n,o));case P:return(o=t.dataState||{})[e.data.id]=e.data.value,D(D({},t),{},{currentText:e.data.value,dataState:o});case k:return D(D({},t),{},{currentStyles:e.data});case S:return i=t[n="stylesState"]||{},e.data.ids.forEach((function(t){i[t]=D(D({},i[t]),e.data.value)})),D(D({},t),{},(R(r={},n,i),R(r,"currentStyles",D(D({},t.currentStyles),e.data.value)),r));case E:return D(D({},t),{},{currentTitle:e.data});case x:return D(D({},t),{},{createDate:(new Date).toJSON()});default:return t}}var $={textAlign:"left",fontWeight:"normal",textDecoration:"none",fontStyle:"normal"},C="Новая таблица";function A(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function N(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?A(Object(r),!0).forEach((function(e){I(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):A(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function I(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var B={rowState:{},colState:{},currentText:"",currentTitle:C,dataState:{},stylesState:{},currentStyles:$,formulaText:"",createDate:(new Date).toJSON()};function H(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var J=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.listeners={}}var e,r;return e=t,r=[{key:"emit",value:function(t){for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];return Array.isArray(this.listeners[t])&&this.listeners[t].forEach((function(t){t.apply(void 0,r)})),!1}},{key:"subscribe",value:function(t,e){var r=this;return this.listeners[t]=this.listeners[t]||[],this.listeners[t].push(e),function(){r.listeners[t]=r.listeners[t].filter((function(t){return t!==e}))}}}],r&&H(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();function M(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var G=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.store=e,this.sub=null,this.prevState={}}var e,r;return e=t,(r=[{key:"subscribeComponents",value:function(t){var e=this;this.prevState=this.store.getState(),this.sub=this.store.subscribe((function(r){Object.keys(r).forEach((function(n){(function(t,e){return"object"===i(t)&&"object"===i(e)?JSON.stringify(t)===JSON.stringify(e):t===e})(e.prevState[n],r[n])||t.forEach((function(t){if(t.subscribe.includes(n)){var e=function(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}({},n,r[n]);t.storeChanged(e)}}))})),e.prevState=e.store.getState()}))}},{key:"unsunscribeFromStote",value:function(){this.sub.unsubscribe()}}])&&M(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();function q(t){return{type:_,data:t}}function z(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var F=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.components=e.components||[],this.store=e.store,this.emitter=new J,this.subscriber=new G(this.store)}var e,n;return e=t,(n=[{key:"getRoot",value:function(){var t=this,e=r.create("div","excel");return this.components=this.components.map((function(n){var o=r.create("div",n.className),i=new n(o,{emitter:t.emitter,store:t.store});return o.html(i.toHTML()),e.append(o),i})),e}},{key:"init",value:function(){this.store.dispatch({type:x}),document.addEventListener("contextmenu",s),this.subscriber.subscribeComponents(this.components),this.components.forEach((function(t){t.init()}))}},{key:"destoy",value:function(){this.subscriber.unsunscribeFromStote(),this.components.forEach((function(t){t.destroy()}))}}])&&z(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function Y(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function W(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var K=function(){function t(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(Y(this,t),!e)throw new Error("No root element!");this.$root=e,this.listeners=r}var e,r;return e=t,(r=[{key:"initDOMListeners",value:function(){var t=this;this.listeners.forEach((function(e){var r=U(e);if(!t[r])throw new Error("There is no ".concat(r," method in Events"));t[r]=t[r].bind(t),t.$root.on(e,t[r])}))}},{key:"removeDOMListeners",value:function(){var t=this;this.listeners.forEach((function(e){var r=U(e);t.$root.off(e,t[r])}))}}])&&W(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();function U(t){return"on"+("string"!=typeof(e=t)?"":e.charAt(0).toLocaleUpperCase()+e.slice(1));var e}function X(t){return X="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},X(t)}function Z(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Q(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function V(t,e){return V=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},V(t,e)}function tt(t,e){if(e&&("object"===X(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function et(t){return et=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},et(t)}var rt=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&V(t,e)}(c,t);var e,r,n,o,i=(n=c,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=et(n);if(o){var r=et(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return tt(this,t)});function c(t){var e,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Z(this,c),(e=i.call(this,t,r.listeners)).name=r.name||"",e.emitter=r.emitter,e.subscribe=r.subscribers||[],e.unsunscribers=[],e.store=r.store,e.prepare(),e}return e=c,r=[{key:"prepare",value:function(){}},{key:"toHTML",value:function(){return""}},{key:"$emit",value:function(t){for(var e,r=arguments.length,n=new Array(r>1?r-1:0),o=1;o<r;o++)n[o-1]=arguments[o];(e=this.emitter).emit.apply(e,[t].concat(n))}},{key:"$on",value:function(t,e){var r=this.emitter.subscribe(t,e);this.unsunscribers.push(r)}},{key:"$disptch",value:function(t){this.store.dispatch(t)}},{key:"storeChanged",value:function(t){}},{key:"init",value:function(){this.initDOMListeners()}},{key:"destroy",value:function(){this.removeDOMListeners(),this.unsunscribers.forEach((function(t){return t()}))}}],r&&Q(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),c}(K);function nt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var ot=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,r;return e=t,r=[{key:"path",get:function(){return window.location.hash.slice(1)}},{key:"param",get:function(){return t.path.split("/")[1]}},{key:"navigate",value:function(t){return window.location.hash=t}}],null&&nt(e.prototype,null),r&&nt(e,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();function it(t){return it="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},it(t)}function ct(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function at(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function ut(t,e){return ut=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},ut(t,e)}function lt(t,e){if(e&&("object"===it(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function st(t){return st=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},st(t)}function ft(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var pt=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ut(t,e)}(a,t);var e,n,o,i,c=(o=a,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=st(o);if(i){var r=st(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return lt(this,t)});function a(t,e){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),c.call(this,t,function(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?ct(Object(r),!0).forEach((function(e){ft(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ct(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}({name:"Header",listeners:["input","click"],subscribers:["currentTitle"]},e))}return e=a,(n=[{key:"prepare",value:function(){this.onInput=l(this.onInput,300)}},{key:"toHTML",value:function(){return'\n    <input type="text" class="input" value="'.concat(this.store.getState().currentTitle||C,'" />\n\n      <div>\n\n        <div class="button" data-type="remove">\n          <i class="material-icons" data-type="remove">delete</i>\n        </div>\n\n        <div class="button" data-type="exit">\n          <i class="material-icons" data-type="exit">exit_to_app</i>\n        </div>\n\n      </div>\n    ')}},{key:"onInput",value:function(t){var e;this.$disptch((e=t.target.value,{type:E,data:e}))}},{key:"onClick",value:function(t){var e=r(t.target);"remove"===e.data.type?confirm("Удалить таблицу ".concat(this.store.getState().currentTitle||C,"?"))&&(localStorage.removeItem(ot.path.replace("/",":")),ot.navigate("")):"exit"===e.data.type&&ot.navigate("")}}])&&at(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),a}(rt);function yt(t){return yt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},yt(t)}function ht(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function bt(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?ht(Object(r),!0).forEach((function(e){vt(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ht(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function vt(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function dt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function gt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function mt(t,e){return mt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},mt(t,e)}function wt(t,e){if(e&&("object"===yt(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function Ot(t){return Ot=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Ot(t)}ft(pt,"className","excel__header");var jt=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&mt(t,e)}(c,t);var e,r,n,o,i=(n=c,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=Ot(n);if(o){var r=Ot(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return wt(this,t)});function c(){dt(this,c);for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return i.call.apply(i,[this].concat(e))}return e=c,r=[{key:"template",get:function(){return JSON.stringify(this.state,null,2)}},{key:"initState",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.state=bt({},t)}},{key:"setState",value:function(t){this.state=bt(bt({},this.state),t),this.$root.html(this.template)}}],r&&gt(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),c}(rt);function _t(t){return _t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_t(t)}function Pt(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function St(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function kt(t,e){return kt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},kt(t,e)}function Et(t,e){if(e&&("object"===_t(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function xt(t){return xt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},xt(t)}function Tt(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var Dt=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&kt(t,e)}(a,t);var e,n,o,i,c=(o=a,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=xt(o);if(i){var r=xt(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return Et(this,t)});function a(t,e){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),c.call(this,t,function(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?Pt(Object(r),!0).forEach((function(e){Tt(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Pt(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}({name:"Toolbar",listeners:["click"],subscribers:["currentStyles"]},e))}return e=a,(n=[{key:"prepare",value:function(){this.initState($)}},{key:"storeChanged",value:function(t){this.setState(t.currentStyles)}},{key:"template",get:function(){return[{icon:"format_align_left",action:"left"===(t=this.state).textAlign,value:{textAlign:"left"}},{icon:"format_align_center",action:"center"===t.textAlign,value:{textAlign:"center"}},{icon:"format_align_right",action:"right"===t.textAlign,value:{textAlign:"right"}},{icon:"format_bold",action:"bold"===t.fontWeight,value:{fontWeight:"bold"===t.fontWeight?"normal":"bold"}},{icon:"format_italic",action:"italic"===t.fontStyle,value:{fontStyle:"italic"===t.fontStyle?"normal":"italic"}},{icon:"format_underline",action:"underline"===t.textDecoration,value:{textDecoration:"underline"===t.textDecoration?"none":"underline"}}].map((function(t){return'\n    <div class="button '.concat(t.action&&"active",'"\n     data-type="button"\n     data-value=').concat(JSON.stringify(t.value),'\n     >\n        <i class="material-icons" \n        data-type="button"\n        data-value=').concat(JSON.stringify(t.value),"\n        >\n            ").concat(t.icon,"\n        </i>\n      </div>\n      ")})).join("");var t}},{key:"toHTML",value:function(){return this.template}},{key:"onClick",value:function(t){if("button"===r(t.target).data.type){var e=JSON.parse(r(t.target).data.value);this.$emit("toolbar:applyStyle",e);var n=Object.keys(e)[0];this.setState(Tt({},n,e[n]))}}}])&&St(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),a}(jt);function Rt(t){return Rt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Rt(t)}function Lt(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function $t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Ct(){return Ct="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,r){var n=At(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(arguments.length<3?t:r):o.value}},Ct.apply(this,arguments)}function At(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Bt(t)););return t}function Nt(t,e){return Nt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Nt(t,e)}function It(t,e){if(e&&("object"===Rt(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function Bt(t){return Bt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Bt(t)}function Ht(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}Tt(Dt,"className","excel__toolbar");var Jt=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Nt(t,e)}(a,t);var e,n,o,i,c=(o=a,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=Bt(o);if(i){var r=Bt(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return It(this,t)});function a(t,e){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),c.call(this,t,function(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?Lt(Object(r),!0).forEach((function(e){Ht(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Lt(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}({name:"Formula",listeners:["input","keydown"],subscribers:["currentText","formulaText"]},e))}return e=a,(n=[{key:"toHTML",value:function(){return'\n    <div class="info">fx</div>\n      <div class="input" id="formula-input" contenteditable spellcheck="false"></div>\n    '}},{key:"init",value:function(){var t=this;Ct(Bt(a.prototype),"init",this).call(this),this.$formula=this.$root.find("#formula-input"),this.$on("table:select",(function(e){t.$formula.text(e.data.value)}))}},{key:"storeChanged",value:function(t){var e=t.currentText;this.$formula.text(e)}},{key:"onInput",value:function(t){t.target.textContent,this.$emit("formula:input",r(t.target).text())}},{key:"onKeydown",value:function(t){"Enter"!==t.key&&"Tab"!==t.key||(t.preventDefault(),this.$emit("formula:keydown"))}}])&&$t(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),a}(rt);Ht(Jt,"className","excel__formula");var Mt=__webpack_require__(665);function Gt(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function qt(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?Gt(Object(r),!0).forEach((function(e){zt(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Gt(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function zt(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Ft(t,e,r){var n=t?'<div class="row-resize" data-resize="row"></div>':"";return'\n    <div class="row" data-type="resizable" data-row="'.concat(t,'" style=height:').concat(r,'>\n        <div class="row-info">\n        ').concat(t,"\n        ").concat(n,'\n        </div>\n        <div class="row-data" data-type="resizable-cols">\n          ').concat(e,"\n        </div>\n      </div>\n    ")}function Yt(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1?arguments[1]:void 0;return(t[e]||120)+"px"}function Wt(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1?arguments[1]:void 0;return(t[e]||24)+"px"}function Kt(t,e,r){return'<div class="column" data-type="resizable" data-col='.concat(e," style=width:").concat(r,"> \n    ").concat(t,'\n    <div class="col-resize" data-resize="col"></div>\n  </div>')}function Ut(t,e,r){var n="".concat(t,":").concat(e),o="".concat(Yt(r.colState,e)),i=r.dataState[n],c=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object.keys(t).map((function(e){return"".concat(u(e),":").concat(t[e])})).join(";")}(qt(qt({},$),r.stylesState[n]));return'<div class="cell" contenteditable data-col="'.concat(e,'"\n  data-id="').concat(n,'"\n  data-value="').concat(i||"",'"\n  style=').concat(c,";width:").concat(o,">\n    ").concat((0,Mt.$)(i)||"","\n  </div>")}function Xt(t,e){return String.fromCharCode(65+e)}function Zt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var Qt=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.group=[],this.current=null}var e,r;return e=t,r=[{key:"select",value:function(t){this.clear(),this.group.push(t),t.focus().addClass("selected"),this.current=t}},{key:"clear",value:function(){this.group.forEach((function(t){return t.removeClass("selected")})),this.group=[]}},{key:"selectedGroup",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.clear(),this.group=t,this.group.forEach((function(t){t.addClass("selected")}))}},{key:"applyStyle",value:function(t){this.group.forEach((function(e){return e.css(t)}))}}],r&&Zt(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();function Vt(t,e){return new Promise((function(n){var o=r(e.target),i=o.closest("[data-type=resizable]"),c=e.target.dataset.resize,a="col"===c?"bottom":"right",u="";o.css(function(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}({opacity:1},a,"-5000px"));var l=i.getCoords(),s=t.findAll('[data-col="'.concat(i.data.col,'"]'));document.onmousemove=function(t){if("col"===c){var e=t.pageX-l.right;u=l.width+e,o.css({right:-u+l.width+"px"})}else{var r=t.pageY-l.bottom;u=l.height+r,o.css({bottom:l.height-u+"px"})}},document.onmouseup=function(t){document.onmousemove=null,document.onmouseup=null,"col"===c?(i.css({width:u+"px"}),s.forEach((function(t){t.style.width=u+"px"})),o.css({right:"0px",opacity:0})):(i.css({height:u+"px"}),o.css({bottom:"0px",opacity:0})),n({value:u,type:c,id:"col"===c?i.data.col:i.data.row})}}))}function te(t){return te="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},te(t)}function ee(){ee=function(){return t};var t={},e=Object.prototype,r=e.hasOwnProperty,n=Object.defineProperty||function(t,e,r){t[e]=r.value},o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",c=o.asyncIterator||"@@asyncIterator",a=o.toStringTag||"@@toStringTag";function u(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function l(t,e,r,o){var i=e&&e.prototype instanceof p?e:p,c=Object.create(i.prototype),a=new S(o||[]);return n(c,"_invoke",{value:O(t,r,a)}),c}function s(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}t.wrap=l;var f={};function p(){}function y(){}function h(){}var b={};u(b,i,(function(){return this}));var v=Object.getPrototypeOf,d=v&&v(v(k([])));d&&d!==e&&r.call(d,i)&&(b=d);var g=h.prototype=p.prototype=Object.create(b);function m(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function w(t,e){function o(n,i,c,a){var u=s(t[n],t,i);if("throw"!==u.type){var l=u.arg,f=l.value;return f&&"object"==te(f)&&r.call(f,"__await")?e.resolve(f.__await).then((function(t){o("next",t,c,a)}),(function(t){o("throw",t,c,a)})):e.resolve(f).then((function(t){l.value=t,c(l)}),(function(t){return o("throw",t,c,a)}))}a(u.arg)}var i;n(this,"_invoke",{value:function(t,r){function n(){return new e((function(e,n){o(t,r,e,n)}))}return i=i?i.then(n,n):n()}})}function O(t,e,r){var n="suspendedStart";return function(o,i){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===o)throw i;return{value:void 0,done:!0}}for(r.method=o,r.arg=i;;){var c=r.delegate;if(c){var a=j(c,r);if(a){if(a===f)continue;return a}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var u=s(t,e,r);if("normal"===u.type){if(n=r.done?"completed":"suspendedYield",u.arg===f)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(n="completed",r.method="throw",r.arg=u.arg)}}}function j(t,e){var r=t.iterator[e.method];if(void 0===r){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=void 0,j(t,e),"throw"===e.method))return f;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return f}var n=s(r,t.iterator,e.arg);if("throw"===n.type)return e.method="throw",e.arg=n.arg,e.delegate=null,f;var o=n.arg;return o?o.done?(e[t.resultName]=o.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,f):o:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,f)}function _(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function P(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function S(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(_,this),this.reset(!0)}function k(t){if(t){var e=t[i];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,o=function e(){for(;++n<t.length;)if(r.call(t,n))return e.value=t[n],e.done=!1,e;return e.value=void 0,e.done=!0,e};return o.next=o}}return{next:E}}function E(){return{value:void 0,done:!0}}return y.prototype=h,n(g,"constructor",{value:h,configurable:!0}),n(h,"constructor",{value:y,configurable:!0}),y.displayName=u(h,a,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===y||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,h):(t.__proto__=h,u(t,a,"GeneratorFunction")),t.prototype=Object.create(g),t},t.awrap=function(t){return{__await:t}},m(w.prototype),u(w.prototype,c,(function(){return this})),t.AsyncIterator=w,t.async=function(e,r,n,o,i){void 0===i&&(i=Promise);var c=new w(l(e,r,n,o),i);return t.isGeneratorFunction(r)?c:c.next().then((function(t){return t.done?t.value:c.next()}))},m(g),u(g,a,"Generator"),u(g,i,(function(){return this})),u(g,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},t.values=k,S.prototype={constructor:S,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(P),!t)for(var e in this)"t"===e.charAt(0)&&r.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function n(r,n){return c.type="throw",c.arg=t,e.next=r,n&&(e.method="next",e.arg=void 0),!!n}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],c=i.completion;if("root"===i.tryLoc)return n("end");if(i.tryLoc<=this.prev){var a=r.call(i,"catchLoc"),u=r.call(i,"finallyLoc");if(a&&u){if(this.prev<i.catchLoc)return n(i.catchLoc,!0);if(this.prev<i.finallyLoc)return n(i.finallyLoc)}else if(a){if(this.prev<i.catchLoc)return n(i.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return n(i.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var c=i?i.completion:{};return c.type=t,c.arg=e,i?(this.method="next",this.next=i.finallyLoc,f):this.complete(c)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),f},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),P(r),f}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;P(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:k(t),resultName:e,nextLoc:r},"next"===this.method&&(this.arg=void 0),f}},t}function re(t,e,r,n,o,i,c){try{var a=t[i](c),u=a.value}catch(t){return void r(t)}a.done?e(u):Promise.resolve(u).then(n,o)}function ne(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function oe(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function ie(){return ie="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,r){var n=ce(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(arguments.length<3?t:r):o.value}},ie.apply(this,arguments)}function ce(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=le(t)););return t}function ae(t,e){return ae=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},ae(t,e)}function ue(t,e){if(e&&("object"===te(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function le(t){return le=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},le(t)}function se(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var fe=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ae(t,e)}(s,t);var e,n,o,i,a,u,l=(a=s,u=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=le(a);if(u){var r=le(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return ue(this,t)});function s(t,e){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,s),l.call(this,t,function(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?ne(Object(r),!0).forEach((function(e){se(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ne(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}({name:"Table",listeners:["mousedown","keydown","input"]},e))}return e=s,n=[{key:"toHTML",value:function(){return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=26,n=[],o=new Array(r).fill("").map(Xt).map((function(t,r){return Kt(t,r,Yt(e.colState,r))})).join("");n.push(Ft("",o,e));for(var i=function(t){var o=new Array(r).fill("").map((function(r,n){return Ut(t,n,e)})).join(""),i=Wt(e.rowState,t+1);n.push(Ft(t+1,o,i))},c=0;c<t;c++)i(c);return n.join("")}(100,this.store.getState())}},{key:"prepare",value:function(){this.selection=new Qt}},{key:"updateTextInStore",value:function(t){var e;this.$disptch((e={value:t,id:this.selection.current.id()},{type:P,data:e}))}},{key:"onInput",value:function(t){r(t.target).text()&&(r(t.target).data.value=""),this.updateTextInStore(r(t.target).text())}},{key:"init",value:function(){var t=this;ie(le(s.prototype),"init",this).call(this);var e=this.$root.find('[data-id="0:0"]');this.selection.select(e),this.$emit("table:select",e),this.$on("formula:input",(function(e){t.selection.current.attr("data-value",e),t.selection.current.text((0,Mt.$)(e)),t.updateTextInStore(e)})),this.$on("formula:keydown",(function(){t.selection.current.focus()})),this.$on("toolbar:applyStyle",(function(e){var r;t.selection.applyStyle(e),t.$disptch((r={value:e,ids:t.selection.group.map((function(t){return t.id()}))},{type:S,data:r}))}))}},{key:"resizeCols",value:(o=ee().mark((function t(e){var r;return ee().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Vt(this.$root,e);case 3:r=t.sent,this.$disptch(q(r)),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),console.log(t.t0.message);case 10:case"end":return t.stop()}}),t,this,[[0,7]])})),i=function(){var t=this,e=arguments;return new Promise((function(r,n){var i=o.apply(t,e);function c(t){re(i,r,n,c,a,"next",t)}function a(t){re(i,r,n,c,a,"throw",t)}c(void 0)}))},function(t){return i.apply(this,arguments)})},{key:"onMousedown",value:function(t){var e,n,o,i,a=this;if(t.target.dataset.resize)this.resizeCols(t);else if(t.target.dataset.id){var u=r(t.target);if(t.shiftKey){var l=(e=this.selection.current.id(!0),n=u.id(!0),o=c(e.col,n.col),i=c(e.row,n.row),o.reduce((function(t,e){return i.forEach((function(r){return t.push("".concat(r,":").concat(e))})),t}),[])).map((function(t){return a.$root.find('[data-id="'.concat(t,'"]'))}));this.selection.selectedGroup(l)}else this.selection.select(u);this.updateTextInStore(u.data.value||u.text());var s=u.getStyles(Object.keys($));this.$disptch({type:k,data:s})}}},{key:"onKeydown",value:function(t){var e=t.key;if(["Tab","Enter","ArrowLeft","ArrowRight","ArrowUp","ArrowDown"].includes(e)&&!t.shiftKey){t.preventDefault();var r=function(t,e){var r=e.row,n=e.col;switch(t){case"Tab":case"ArrowRight":n++;break;case"Enter":case"ArrowDown":r++;break;case"ArrowUp":0!==r&&r--;break;case"ArrowLeft":0!==n&&n--}return{row:r,col:n}}(e,this.selection.current.id(!0)),n=this.$root.find('[data-id="'.concat(r.row,":").concat(r.col,'"]'));this.selection.select(n),this.$emit("table:select",n),this.updateTextInStore(n.text())}}}],n&&oe(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),s}(rt);function pe(t){return pe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},pe(t)}function ye(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function he(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function be(t,e){return be=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},be(t,e)}function ve(t,e){if(e&&("object"===pe(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function de(t){return de=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},de(t)}function ge(t){return"excel:"+t}se(fe,"className","excel__table");var me=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&be(t,e)}(c,t);var e,r,n,o,i=(n=c,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=de(n);if(o){var r=de(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return ve(this,t)});function c(){return ye(this,c),i.apply(this,arguments)}return e=c,(r=[{key:"getRoot",value:function(){var t=this.params?this.params:Date.now().toString(),e=a(ge(t)),r=new j(L,function(t){return t?function(t){return N(N({},t),{},{currentStyles:$,currentText:""})}(t):(e=B,JSON.parse(JSON.stringify(e)));var e}(e)),n=l((function(e){a(ge(t),e)}),300);return r.subscribe(n),this.excel=new F({components:[pt,Dt,Jt,fe],store:r}),this.excel.getRoot()}},{key:"afterRender",value:function(){this.excel.init()}},{key:"destroy",value:function(){this.excel.destoy()}}])&&he(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),c}(o);function we(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var Oe=function(){function t(e,n){if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),!e)throw new Error("selector is not provided!");this.routes=n,this.$placeholder=r(e),this.page=null,this.changePageHandler=this.changePageHandler.bind(this),this.init()}var e,n;return e=t,n=[{key:"init",value:function(){window.addEventListener("hashchange",this.changePageHandler),this.changePageHandler()}},{key:"changePageHandler",value:function(t){this.page&&this.page.destroy(),this.$placeholder.clear();var e=ot.path.includes("excel")?this.routes.excel:this.routes.dashboard;this.page=new e(ot.param),this.$placeholder.append(this.page.getRoot()),this.page.afterRender()}},{key:"destroy",value:function(){window.removeEventListener("hashchange",this.changePageHandler)}}],n&&we(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();new Oe("#app",{dashboard:g,excel:me})}()})();